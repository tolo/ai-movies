<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Movie Hub - TMDB Explorer</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f0f0f0;
            margin: 0;
            padding: 0;
        }
        #movies {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            padding: 20px;
        }
        .movie {
            background-color: #ffffff;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            width: 200px;
            cursor: pointer;
        }
        .movie img {
            width: 100%;
            height: auto;
        }
        .movie-title {
            padding: 15px;
            font-size: 1rem;
            text-align: center;
        }
        #filter {
            display: flex;
            justify-content: center;
            margin: 20px;
        }
        #filter select {
            padding: 10px;
            font-size: 1rem;
        }
        #movie-details {
            display: none;
            padding: 20px;
        }
        #back-button {
            cursor: pointer;
            color: blue;
            text-decoration: underline;
            margin-bottom: 20px;
            display: inline-block;
        }
    </style>
</head>
<body>
    <h1 style="text-align: center;">Movies</h1>
    <div id="filter">
        <select id="category">
            <option value="popular">Trending Now</option>
            <option value="now_playing">Fresh Releases</option>
            <option value="top_rated">All-Time Faves</option>
            <option value="upcoming">Coming Soon</option>
        </select>
    </div>
    <div id="movies"></div>
    <div id="movie-details">
        <span id="back-button">&larr; Back to Movies</span>
        <div id="details-content"></div>
    </div>

    <script>
        const API_KEY = 'YOUR_TMDB_API_KEY';
        const IMAGE_URL = 'https://image.tmdb.org/t/p/w500';

        // Add event listener to category dropdown to fetch movies based on the selected category with debounce
        document.getElementById('category').addEventListener('change', debounce((event) => {
            fetchMovies(event.target.value); // Fetch movies for the selected category
        }, 300));

        // Debounce function to limit how often a function can run
        function debounce(func, delay) {
            let timeoutId;
            return function (...args) {
                clearTimeout(timeoutId);
                timeoutId = setTimeout(() => {
                    func.apply(this, args);
                }, delay);
            };
        }

        // Fetch movies from the TMDB API based on the selected category
        async function fetchMovies(category) {
            const API_URL = `https://api.themoviedb.org/3/movie/${category}?api_key=${API_KEY}&language=en-US&page=1`;
            try {
                const response = await fetch(API_URL);
                if (!response.ok) {
                    throw new Error('Failed to fetch movies');
                }
                const data = await response.json();
                if (data.results && data.results.length > 0) {
                    displayMovies(data.results); // Display movies if available
                } else {
                    displayNoMoviesFound(); // Display message if no movies found
                }
            } catch (error) {
                console.error('Error:', error); // Log error if fetching fails
            }
        }

        // Display the list of movies on the main page
        function displayMovies(movies) {
            const moviesContainer = document.getElementById('movies');
            const movieDetails = document.getElementById('movie-details');
            moviesContainer.style.display = 'flex';
            movieDetails.style.display = 'none';
            moviesContainer.innerHTML = ''; // Clear previous movies

            // Loop through each movie and create a card for it
            movies.forEach(movie => {
                const movieElement = document.createElement('div');
                movieElement.classList.add('movie');
                movieElement.dataset.movieId = movie.id; // Store movie ID for later use

                // Set the inner HTML for the movie card
                movieElement.innerHTML = `
                    <img src="${IMAGE_URL}${movie.poster_path}" alt="${movie.title}">
                    <div class="movie-title">${movie.title}</div>
                `;

                // Add click event to fetch and display movie details
                movieElement.addEventListener('click', () => {
                    fetchMovieDetails(movie.id);
                });

                // Append the movie card to the container
                moviesContainer.appendChild(movieElement);
            });
        }

        // Fetch and display detailed information about a specific movie
        async function fetchMovieDetails(movieId) {
            const API_URL = `https://api.themoviedb.org/3/movie/${movieId}?api_key=${API_KEY}&language=en-US`;
            try {
                const response = await fetch(API_URL);
                if (!response.ok) {
                    throw new Error('Failed to fetch movie details');
                }
                const movie = await response.json();
                displayMovieDetails(movie); // Display detailed movie information
            } catch (error) {
                console.error('Error:', error); // Log error if fetching fails
            }
        }

        // Display detailed information about a selected movie
        function displayMovieDetails(movie) {
            const moviesContainer = document.getElementById('movies');
            const movieDetails = document.getElementById('movie-details');
            const detailsContent = document.getElementById('details-content');
            
            moviesContainer.style.display = 'none'; // Hide the main movie list
            movieDetails.style.display = 'block'; // Show the movie details section

            // Set the inner HTML for the movie details section
            detailsContent.innerHTML = `
                <h2>${movie.title}</h2>
                <img src="${IMAGE_URL}${movie.poster_path}" alt="${movie.title}" style="width: 300px;">
                <p><strong>Release Date:</strong> ${movie.release_date}</p>
                <p><strong>Rating:</strong> ${movie.vote_average} / 10</p>
                <p><strong>Overview:</strong> ${movie.overview}</p>
            `;
        }

        // Add event listener to the back button to return to the main movie list
        document.getElementById('back-button').addEventListener('click', () => {
            const moviesContainer = document.getElementById('movies');
            const movieDetails = document.getElementById('movie-details');
            moviesContainer.style.display = 'flex'; // Show the main movie list
            movieDetails.style.display = 'none'; // Hide the movie details section
        });

        // Display message if no movies are found
        function displayNoMoviesFound() {
            const moviesContainer = document.getElementById('movies');
            moviesContainer.innerHTML = '<p style="text-align: center; width: 100%;">No movies found.</p>'; // Set message for no movies
        }

        // Fetch and display the default category ('popular') when the page loads
        document.addEventListener('DOMContentLoaded', () => fetchMovies('popular'));
    </script>
</body>
</html>
